<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Expires" content="0">
		<title>CMU Fence</title>

		<meta name="title" content="CMU Fence">
		<meta name="description" content="See the fence at Carnegie Mellon University.">

		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="manifest" href="/site.webmanifest">
		<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="theme-color" content="#ffffff">

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

		<link href="https://fonts.googleapis.com/css?family=Material+Icons" rel="stylesheet">
		<link rel="stylesheet" href="/style.css">
		<script src="/main.js"></script>
	</head>
	<body data-bs-theme="dark" >
		<nav class="navbar navbar-expand-lg bg-body-tertiary">
			<div class="container-fluid">
				<a class="navbar-brand" href="/" onclick="navigate('/'); toggleNav(); return false;">
					<img src="/images/logo.svg" alt="Logo" width="24" height="24" class="d-inline-block align-text-top">
					CMU Fence
				</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" id="toggle_nav_button">
				<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0" style="margin-right: 10px;">
						<li class="nav-item">
						<a id="nav_home" class="nav-link" href="/" onclick="navigate('/'); toggleNav(); return false;">Today's Fence</a>
						</li>
						<li class="nav-item">
						<a id="nav_history" class="nav-link" href="/history" onclick="navigate('/history'); toggleNav(); return false;">Fence History</a>
						</li>
						<li class="nav-item">
						<a id="nav_leaderboard" class="nav-link" href="/leaderboard" onclick="navigate('/leaderboard'); toggleNav(); return false;">Leaderboard</a>
						</li>
						<li class="nav-item">
						<a id="nav_rules" class="nav-link" href="/rules" onclick="navigate('/rules'); toggleNav(); return false;">Fence Rules</a>
						</li>
						<li class="nav-item dropdown menu_item_hidden" id="account_menu">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" id="account_display_name">
								Name
							</a>
							<ul class="dropdown-menu">
								<!-- <li><a class="dropdown-item" href="#">Profile</a></li>
								<li><hr class="dropdown-divider"></li> -->
								<li><a class="dropdown-item" href="javascript:signOut();">Sign out</a></li>
							</ul>
						</li>
					</ul>
					<div class="d-flex menu_item_hidden" id="sign_in_button">
						<button class="btn btn-outline-light" type="submit" onclick="signIn()">Sign in</button>
					</div>
					<div class="d-flex menu_item_hidden" id="scan_fence_button">
						<button class="btn btn-outline-light" type="submit" onclick="navigate('/scan')">Scan the fence</button>
					</div>
				</div>
			</div>
		</nav>

		<div id="container_home">
			<div class="home_top">
				<img src="/images/fenceplaceholder.jpg" style="width: 100%; margin: 0 auto; max-width: 1500px; display: block;">
			</div>
			<div class="home_bottom">
				<div id="fence_date"></div>
				<div class="section_title">Message</div>
				<div id="fence_message"></div>
				<div class="section_title">Organization</div>
				<div id="fence_organization"></div>
				<div class="section_title">Painters</div>
				<div id="painters_list">
				</div>
			</div>
		</div>

		<div id="container_history">
			<div style="overflow: hidden; padding-top: 5px; padding-bottom: 5px;">
				<div class="cal_chev"><a href="/history" onclick="calChevPrev(); return false;"><i class="material-icons">chevron_left</i></a></div>
				
				<div class="cal_chev" style="float: right;"><a href="/history" onclick="calChevNext(); return false;"><i class="material-icons">chevron_right</i></a></div>

				<div id="month_name"></div>
			</div>
			<div id="calendar_container">
				<div class="equal_grid">
					<div class="cal_month_row">Sun</div>
					<div class="cal_month_row">Mon</div>
					<div class="cal_month_row">Tue</div>
					<div class="cal_month_row">Wed</div>
					<div class="cal_month_row">Thu</div>
					<div class="cal_month_row">Fri</div>
					<div class="cal_month_row">Sat</div>
				</div>
				<div id="cal_month_inner">

				</div>
			</div>
		</div>

		<div id="container_leaderboard">

		</div>

		<div id="container_rules">

		</div>

		<div id="container_scan">

		</div>

		<script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-app-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-auth-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-database-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-storage-compat.js"></script>

		<script>
			// if ('scrollRestoration' in history) {
			// 	// Back off, browser, I got this...
			// 	history.scrollRestoration = 'manual';//'manual' we generally want this, only disable when we dont
			// }

			var config = {
				apiKey: "AIzaSyDW1GvlTQAOft8jQTzSlG31EfZGuBNFPwE",
				authDomain: "cmu-fence.firebaseapp.com",
				projectId: "cmu-fence",
				storageBucket: "cmu-fence.appspot.com",
				messagingSenderId: "83881276065",
				appId: "1:83881276065:web:5c6b68439a54ef2acb36e0"
			};
			firebase.initializeApp(config);

			firebase.auth().onAuthStateChanged(function (user) {
				if (user) {

					gid("account_menu").classList.remove("menu_item_hidden");
					gid("sign_in_button").classList.add("menu_item_hidden");
					gid("scan_fence_button").classList.remove("menu_item_hidden");

					gid("account_display_name").innerHTML = '<img class="pfp" src="'+firebase.auth().currentUser.photoURL+'"></img>'+htmlescape(user.displayName);

				} else {
					gid("account_menu").classList.add("menu_item_hidden");
					gid("sign_in_button").classList.remove("menu_item_hidden");
					gid("scan_fence_button").classList.add("menu_item_hidden");
				}
			});

			checkState();
		</script>
	</body>
</html>
